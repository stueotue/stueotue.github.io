[ { "title": "XSLEAKS error-based lead to disclose the visitor Facebook ID", "url": "/posts/xsleaks-tracking-facebook-user/", "categories": "Bug-Bounty, Writeup", "tags": "facebook", "date": "2021-06-24 13:00:24 +0800", "snippet": "DescriptionThe ajax bootloader endpoint (https://web.facebook.com/ajax/bootloader-endpoint/), is used to load react modules. An error-based xsleaks happen in this endpoint when all the get parameter is removed except the __user and __a=1 (https://web.facebook.com/ajax/bootloader-endpoint/?__user=USERID&amp;amp;__a=1). This endpoint will return 404 status code if the __user parameter value match with the logged in user id and will return 200 if its not match. It is possible to detect these 2 state (404 and 200 status code) using onload and onerror event. making an attacker to detect whether the target user is visited the attacker controlled webpage.ImpactThis endpoint could have let a malicious website determine which Facebook user was visiting them due to XSLeaks.FBDL Run [setup] User UserOne User UserTwo Results: UserOne =&amp;gt; 100066013862573 UserTwo =&amp;gt; 100065449647222Steps to reproduce Log in to Facebook as UserOne Open other website (e.g https://google.com) Open the browser console (Right Click -&amp;gt; Inspect Element -&amp;gt; Console Tab) Copy paste this script to the console : var id = &#39;100066013862573&#39; // UserOne ID var script = document.createElement(&#39;script&#39;); script.src = `https://web.facebook.com/ajax/bootloader-endpoint/?__user=${id}&amp;amp;__a=1` script.onload = () =&amp;gt; console.log(&#39;Nope&#39;); script.onerror = e =&amp;gt; console.log(&#39;Match&#39;); document.head.appendChild(script);This should print “Match” in the console.Reference https://hackerone.com/reports/505424Timeline Apr 07, 2021 - Report sent Apr 12, 2021 - Triaged Jun 24, 2021 - Fixed Jun 24, 2021 - Bounty awarded $1250 Jun 27, 2021 - Send information that the fix can be bypass and open a new report (1) Jun 29, 2021 - Triaged (new report) Jul 23, 2021 - Bounty awarded $1313 (Including Bonus) Jul 24, 2021 - Fixed The fix can be bypass by adding a non numeric character in the last __user parameter value__user=1001 -&amp;gt; __user=1001a " }, { "title": "Report a content as page analyst on behalf a page", "url": "/posts/report-a-content-as-page-analyst/", "categories": "Bug-Bounty, Writeup", "tags": "facebook", "date": "2021-04-16 13:00:24 +0800", "snippet": "DescriptionIn Facebook pages, page analysts roles can only view insight, view page quality and view who published a post as page (https://web.facebook.com/help/289207354498410).I’ve found a privilege escalation which can make page analyst report a post/comment on behalf the Page.ImpactA page analyst able to report a post comment on behalf of the page.FBDL Run[setup]User PageOwnerUser PageAnalystUser PageLikerPage PageOne with {owner: PageOwner, analysts: [PageAnalyst]}[action]PageLiker like_page PageOnePageOwner as PageOne make_post_text TextPost with {place: PageOne}PageLiker make_comment CommentOne with {place: TextPost}PageLiker like_post TextPostResults:PageOwner =&amp;gt; 100063478280307PageAnalyst =&amp;gt; 100063829416094PageLiker =&amp;gt; 100063944491179PageOne =&amp;gt; 104618658339393TextPost =&amp;gt; 104618881672704CommentOne =&amp;gt; 104618955006030Steps to Reproduce Log in as PageAnalyst Go to PageOne Post (https://web.facebook.com/104618881672704) Report the PageLiker comment by clicking the Three Dots -&amp;gt; Give feedback or report this comment Use Harrasment as the report problem and click Next. Check the “Yes, I’d like to continue filling this report” and click Next Go to page support inbox (https://web.facebook.com/104618658339393/settings/?tab=support_dashboard) and you’ll see the report from the PageAnalyst goes there.VideoTimeline Feb 17, 2021 - Report sent Feb 23, 2021 - Triaged Apr 13, 2021 - Fixed Apr 16, 2021 - Bounty awarded $525" }, { "title": "Answering group quiz on behalf page as page analyst", "url": "/posts/answering-quiz-as-page-analyst/", "categories": "Bug-Bounty, Writeup", "tags": "facebook", "date": "2020-01-27 11:12:24 +0800", "snippet": "DescriptionWhen the page is linked to the group and the page analyst is the member of the group, the page analyst can answer the quiz on behalf the page.ImpactA page analyst is able to take a group quiz on page’s behalf.Steps to reproduce Attacker go to the unit tab which had a quiz. (https://web.facebook.com/groups/GROUP_ID/learning_content/?filter=UNIT_ID) Attacker answer the quiz and intercept the requests (using Burp suite or another http interceptor) Attacker change the value of av parameter to page_id Attacker Forward/Send the requests When victim download the quiz results, it will appear as the page that answer the quiz.VideoTimeline Dec 15, 2019 - Report sent Dec 18, 2019 - Triaged Jan 26, 2020 - Fixed Jan 27, 2020 - Bounty awarded $750" }, { "title": "XSLeaks Leaking the page roles of users", "url": "/posts/tracking-page-admin-roles/", "categories": "Bug-Bounty, Writeup", "tags": "facebook", "date": "2019-06-21 14:20:21 +0800", "snippet": "DescriptionI was reading this blog about XSLeaks issue in facebook which using window.length to return a number of frames inside the document and use it to extract data from facebook user who visit the Third Party website.So, i start to find the same issue in facebook and i found the same thing in https://web.facebook.com/page_username/inbox. You can check if the endpoint has the same issue by typing frames.length in the browser console, in my case it return 3 and This endpoint is only accessible by user who has admin/editor/moderator role. So, if user with no role or had different role besides admin, editor and moderator, it will display a 404 page and the 404 page has 0 frames.length.ImpactThe vulnerability reported leaked the page role of users using frames.length through /inbox endpoint. Thank you for reporting this to us.Steps to reproduce&amp;lt;script&amp;gt;var page = &quot;Your Page Username&quot;if (fb === undefined) { var fb = window.open() // Creating window reference}fb.location = &#39;https://web.facebook.com/&#39;+page+&#39;/inbox/&#39; // Change the window locationsetTimeout(() =&amp;gt; { var answer = fb.frames.length == 0 ? &#39;No&#39; : &#39;Yes&#39; var mb = fb.frames.length &amp;gt; 1 ? &#39;No&#39; : &#39;Yes&#39; console.log(&#39;Are you an Admin/Editor/Moderator in : &#39; + page + &#39; ? -- &#39; + answer +&#39; Mailbox Empty ? -- &#39;+ mb) fb.close() }, 5000)&amp;lt;/script&amp;gt;VideoTimeline May 20, 2019 - Report sent May 23, 2019 - Triaged Jun 11, 2019 - Fixed Jun 21, 2019 - Bounty awarded $750" }, { "title": "Inviting group member to join watch party as page analyst on behalf page", "url": "/posts/invite-member-to-watch-party-as-page/", "categories": "Bug-Bounty, Writeup", "tags": "facebook", "date": "2019-01-10 14:20:21 +0800", "snippet": "DescriptionIt is possible for page analyst to invite another group-linked-page member to watch party on behalf the page itself.ImpactThis would allow a group-linked Page Analyst to be able to invite Group members to join the watch party as the Page instead of their normal user.Steps to reproduce As page analyst create a watch party in group and you will redirect to https://www.facebook.com/groups//wp/ Once you redirect, change the url to https://www.facebook.com/groups//wp//?av= Now go to invite menu and invite any group member and they will receive the notification from the page.VideoTimeline Aug 22, 2018 - Report sent Aug 25, 2018 - Triaged Sep 06, 2018 - Fixed Sep 23, 2018 - Send information (still incomplete fix) Oct 04, 2018 - Bounty awarded $500 Jan 10, 2019 - All Fixed" }, { "title": "Adding video to the watch party on behalf page as page analyst", "url": "/posts/adding-video-to-wp-as-page-analyst/", "categories": "Bug-Bounty, Writeup", "tags": "facebook", "date": "2019-01-10 11:12:24 +0800", "snippet": "DescriptionWhen the page is linked to the group and the page analyst is the member of the group, the page analyst can add a watch video on behalf the page. But to do that, the page analyst should be a Host / Co-Host to the watch party.ImpactThis bug could allow a page analyst to add a video to a watch party on behalf of a linked page, when they should not be able to do so.Steps to reproduce Attacker create a watch party in the group-linked page (https://www.facebook.com/groups/GROUP_ID) Attacker will redirect to the watch party with the following url like this (https://www.facebook.com/groups/GROUP_D/wp/WATCH_PARTY_ID Attacker added a video by clicking the Add Video &amp;gt; Click a video to be added &amp;gt; Intercept the request using burp/ any http intercept.The following request and response &amp;gt; https://pastebin.com/SbKRnWtV Attacker modifying the Creator_actor_id to Page ID. Attacker then send the request.VideoTimeline Nov 02, 2018 - Report sent Nov 07, 2018 - Triaged Dec 20, 2018 - Bounty awarded $500 Jan 10, 2019 - Fixed" }, { "title": "Disclose group learning unit insight", "url": "/posts/disclose-group-learning-unit-insight/", "categories": "Bug-Bounty, Writeup", "tags": "facebook", "date": "2018-09-01 14:20:21 +0800", "snippet": "DescriptionThere is an IDOR issue in a feature called learning unit which lead to disclose the Group Insight. If the targeted group privacy is public, then attacker can disclose the group insight without become a member and for closed/secret group privacy, attacker need to become a member.ImpactThis could have allowed a group member to add Learning Units to their own Group, which would have then allowed them to download the Group Insights for those Learning Units.Steps to reproduce Bob go to Victim Group and started to browse to Victim Group learning unit.From here Bob collect the Unit Name/Unit ID from the Victim Group: HTML/10 Javascript/20 Python/30 Test Section/40 Bob go to his group (Attacker Group) and open his Social Learning Unit (https://www.facebook.com/groups/2/learning_content/) Bob click on the Settings, open his burpsuite and turn on the intercept. Bob Click the Save button and capture the request using burpsuite.Request :POST /groups/learning/edit_units_dialog/submit/group_id=298905900874017&amp;amp;description=&amp;amp;unit_ids[0]=5 Bob edit the request by adding the Victim Group unit_idsEditted Request :POST /groups/learning/edit_units_dialog/submit/group_id=298905900874017&amp;amp;description=&amp;amp;unit_ids[0]=10&amp;amp;unit_ids[1]=20&amp;amp;unit_ids[2]=30&amp;amp;unit_ids[3]=40 Bob forward the request. From here the Victim Group Learning unit is shown up in Attacker Group. Bob go to “Group Insight” from his group (Attacker Group) and can see the Victim Unit details. For more detail, Bob click the “Download Details” from his group insight (Attacker Group), wait for the notification from Facebook.To download the insight the url is : https://www.facebook.com/groups/GROUPID/completions_export/ After get notification Bob open a new tab from his browser and entering this url :https://www.facebook.com/groups/2/completions_export/Finally Bob can see the Victim unit progress, which member already complete the learning unit etc..VideoTimeline Aug 18, 2018 - Report sent Aug 23, 2018 - Triaged Sep 1, 2018 - Fixed Sep 1, 2018 - Bounty awarded $1500" } ]
